{
  "openapi": "3.0.0",
  "info": {
    "title": "demand-public-api",
    "version": "1.0.0",
    "description": "Demand Public API"
  },
  "paths": {
    "/boot/{id}": {
      "get": {
        "summary": "Initialize an authenticated user",
        "description": "This endpoint initializes an authenticated user and returns their available reports and entities.",
        "tags": ["Boot"],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "User ID"
          }
        ],
        "responses": {
          "200": {
            "description": "User initialized successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "availableReports": {
                      "type": "integer",
                      "example": 10
                    },
                    "availableEntities": {
                      "type": "integer",
                      "example": 1000
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "User is not authorized to use Demand"
          }
        }
      }
    },
    "/entity/request": {
      "post": {
        "summary": "Request entities",
        "tags": ["Entities"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "entityNames": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "example": ["entity1", "entity2"]
                  },
                  "userEmail": {
                    "type": "string",
                    "format": "email",
                    "example": "user@example.com"
                  }
                },
                "required": ["entityNames", "userEmail"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Entities requested successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "example": "https://drive.google.com/file/d/1A2B3C4D5E6F7G8H9I0J/view?usp=sharing"
                }
              }
            }
          },
          "400": {
            "description": "Bad request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/entity/check": {
      "post": {
        "summary": "Check entity status",
        "tags": ["Entities"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "entities": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "example": ["entity1"]
                  }
                },
                "required": ["entities"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Entity status checked successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "q": {
                        "type": "string",
                        "description": "The queried entity name/reference"
                      },
                      "valid": {
                        "type": "boolean",
                        "description": "Whether the entity exists"
                      },
                      "name": {
                        "type": ["string", "null"],
                        "description": "The entity name if found"
                      },
                      "reference": {
                        "type": ["string", "null"],
                        "description": "The entity reference if found"
                      },
                      "reason": {
                        "type": "string",
                        "description": "The reason why the entity is not valid",
                        "enum": ["not_found"]
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/entity": {
      "get": {
        "summary": "Get entities",
        "tags": ["Entities"],
        "parameters": [
          {
            "in": "query",
            "name": "nameOrReference",
            "schema": {
              "type": "string"
            },
            "required": true,
            "description": "Name or reference to search for"
          }
        ],
        "responses": {
          "200": {
            "description": "Entities retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "entities": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "name": {
                            "type": "string"
                          },
                          "reference": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/demand-report": {
      "post": {
        "summary": "Create a demand report",
        "tags": ["DemandReport"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "title": {
                    "type": "string",
                    "example": "A report title"
                  },
                  "entitiesReferences": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "example": ["iagoaspas"]
                  },
                  "userEmail": {
                    "type": "string",
                    "format": "email",
                    "example": "demand@audiense.com"
                  }
                },
                "required": ["title", "entitiesReferences", "userEmail"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Demand report created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string"
                    },
                    "email": {
                      "type": "string",
                      "format": "email"
                    },
                    "isAuthorized": {
                      "type": "boolean"
                    },
                    "availableReports": {
                      "type": "integer"
                    },
                    "availableEntities": {
                      "type": "integer"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "object",
                      "properties": {
                        "reason": {
                          "type": "string",
                          "enum": ["entities_missing", "entities_limit_reached"]
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/reports": {
      "get": {
        "summary": "Get user reports",
        "tags": ["Reports"],
        "parameters": [
          {
            "in": "query",
            "name": "paginationStart",
            "schema": {
              "type": "integer",
              "minimum": 0
            },
            "description": "Pagination start index"
          },
          {
            "in": "query",
            "name": "paginationEnd",
            "schema": {
              "type": "integer",
              "minimum": 0
            },
            "description": "Pagination end index"
          }
        ],
        "responses": {
          "200": {
            "description": "User reports retrieved successfully",
            "headers": {
              "X-Total-Count": {
                "schema": {
                  "type": "string"
                },
                "description": "Total number of reports"
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "reports": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "example": "123e4567-e89b-12d3-a456-426614174000"
                          },
                          "title": {
                            "type": "string",
                            "example": "Monthly Report"
                          },
                          "userId": {
                            "type": "string",
                            "example": "aTestUserId"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/report": {
      "get": {
        "summary": "Get report by ID",
        "tags": ["Reports"],
        "parameters": [
          {
            "in": "query",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Report ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Report retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/reports/summary-by-channels": {
      "get": {
        "summary": "Get report summary by channels",
        "tags": ["Reports"],
        "parameters": [
          {
            "in": "query",
            "name": "reportId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Report ID"
          },
          {
            "in": "query",
            "name": "country",
            "schema": {
              "type": "string"
            },
            "description": "Country code"
          },
          {
            "in": "query",
            "name": "entityNames",
            "schema": {
              "type": "string"
            },
            "description": "JSON stringified array of entity names"
          },
          {
            "in": "query",
            "name": "offset",
            "schema": {
              "type": "string"
            },
            "description": "Pagination offset"
          }
        ],
        "responses": {
          "200": {
            "description": "Report summary retrieved successfully",
            "headers": {
              "X-Total-Count": {
                "schema": {
                  "type": "string"
                },
                "description": "Total number of items"
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "entity": {
                        "type": "string"
                      },
                      "countryRanking": {
                        "type": "number"
                      },
                      "instagram": {
                        "type": "object",
                        "properties": {
                          "rank": {
                            "type": "number"
                          },
                          "absolute": {
                            "type": "number"
                          }
                        }
                      },
                      "x": {
                        "type": "object",
                        "properties": {
                          "rank": {
                            "type": "number"
                          },
                          "absolute": {
                            "type": "number"
                          }
                        }
                      },
                      "tiktok": {
                        "type": "object",
                        "properties": {
                          "rank": {
                            "type": "number"
                          },
                          "absolute": {
                            "type": "number"
                          }
                        }
                      },
                      "url": {
                        "type": "object",
                        "properties": {
                          "rank": {
                            "type": "number"
                          },
                          "absolute": {
                            "type": "number"
                          }
                        }
                      },
                      "google": {
                        "type": "object",
                        "properties": {
                          "rank": {
                            "type": "number"
                          },
                          "absolute": {
                            "type": "number"
                          }
                        }
                      },
                      "googleGrowth": {
                        "type": "object",
                        "properties": {
                          "rank": {
                            "type": "number"
                          },
                          "absolute": {
                            "type": "number"
                          }
                        }
                      },
                      "youtubeChannel": {
                        "type": "object",
                        "properties": {
                          "rank": {
                            "type": "number"
                          },
                          "absolute": {
                            "type": "number"
                          }
                        }
                      },
                      "youtubeSearch": {
                        "type": "object",
                        "properties": {
                          "rank": {
                            "type": "number"
                          },
                          "absolute": {
                            "type": "number"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/reports/summary-by-countries": {
      "get": {
        "summary": "Get report summary by countries",
        "tags": ["Reports"],
        "parameters": [
          {
            "in": "query",
            "name": "reportId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Report ID"
          },
          {
            "in": "query",
            "name": "platform",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Platform name"
          },
          {
            "in": "query",
            "name": "countries",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "JSON stringified array of country codes"
          },
          {
            "in": "query",
            "name": "entityNames",
            "schema": {
              "type": "string"
            },
            "description": "JSON stringified array of entity names"
          },
          {
            "in": "query",
            "name": "offset",
            "schema": {
              "type": "string"
            },
            "description": "Pagination offset"
          }
        ],
        "responses": {
          "200": {
            "description": "Report summary retrieved successfully",
            "headers": {
              "X-Total-Count": {
                "schema": {
                  "type": "string"
                },
                "description": "Total number of items"
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "entity": {
                        "type": "string"
                      },
                      "generalRanking": {
                        "type": "number"
                      },
                      "platformRanking": {
                        "type": "number"
                      },
                      "countriesSummary": {
                        "type": "array",
                        "items": {
                          "type": "object"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/reports/youtube-search-volume-summary": {
      "get": {
        "summary": "Get YouTube search volume summary",
        "tags": ["Reports"],
        "parameters": [
          {
            "in": "query",
            "name": "reportId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Report ID"
          },
          {
            "in": "query",
            "name": "country",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Country code"
          },
          {
            "in": "query",
            "name": "entityNames",
            "schema": {
              "type": "string"
            },
            "description": "JSON stringified array of entity names"
          }
        ],
        "responses": {
          "200": {
            "description": "YouTube search volume summary retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "initialDate": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "entities": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "name": {
                            "type": "string"
                          },
                          "volumes": {
                            "type": "array",
                            "items": {
                              "type": ["number", "null"]
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Report not found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/reports/search-volume-summary": {
      "get": {
        "summary": "Get search volume summary",
        "tags": ["Reports"],
        "parameters": [
          {
            "in": "query",
            "name": "reportId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Report ID"
          },
          {
            "in": "query",
            "name": "country",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Country code"
          },
          {
            "in": "query",
            "name": "entityNames",
            "schema": {
              "type": "string"
            },
            "description": "JSON stringified array of entity names"
          }
        ],
        "responses": {
          "200": {
            "description": "Search volume summary retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "initialDate": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "entities": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "name": {
                            "type": "string"
                          },
                          "volumes": {
                            "type": "array",
                            "items": {
                              "type": ["number", "null"]
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Report not found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/elb_check": {
      "get": {
        "summary": "Health check endpoint",
        "tags": ["Status"],
        "responses": {
          "200": {
            "description": "Server is healthy",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "ok"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Server is not healthy"
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    }
  },
  "security": [
    {
      "bearerAuth": []
    }
  ]
}
